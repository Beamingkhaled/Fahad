<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
<title>Ø´Ù†Ø³ÙˆÙŠ Ø§Ù„ÙˆÙŠÙƒÙ†Ø¯ØŸ â€” Ù…ÙØ±Ø´ÙÙ‘Ø­ Ø§Ù„Ø£Ù†Ø´Ø·Ø©</title>
<style>
:root{
  --bg1:#0f1022; --bg2:#132b38;
  --panel:rgba(255,255,255,.06); --stroke:rgba(255,255,255,.14);
  --text:#fff; --muted:#cfd8dc;
  --accent:#ff2bd1; --accent2:#7c3aed;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; color:var(--text);
  -webkit-text-size-adjust:100%;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Noto Kufi Arabic", "Noto Sans", Arial, sans-serif;
  background:
    radial-gradient(1200px 1200px at 10% -10%, #1e1b4b 0%, transparent 60%),
    radial-gradient(900px 900px at 110% 10%, #0ea5e9 0%, transparent 50%),
    linear-gradient(160deg,var(--bg1),var(--bg2));
  min-height:100vh;            /* fallback */
  min-height:100svh;           /* iOS safe, avoids toolbar jump */
  -webkit-overflow-scrolling:touch;
  overflow-x:hidden;
  padding:16px 12px;
  padding-top:calc(16px + env(safe-area-inset-top));
  padding-bottom:calc(16px + env(safe-area-inset-bottom));
}
.app{
  width:100%;
  max-width:720px;             /* fills iPhone nicely */
  margin-inline:auto;
  background:var(--panel);
  border:1px solid var(--stroke);
  border-radius:22px;
  box-shadow:0 10px 32px rgba(0,0,0,.35);
  overflow:hidden;
}
header{
  display:flex; align-items:center; justify-content:space-between; gap:10px;
  padding:12px 14px;
}
.brand{display:flex; align-items:center; gap:10px}
.logoimg{height:44px; width:auto; display:block; filter: drop-shadow(0 0 10px rgba(255,43,209,.35))}
.title{font-weight:800; font-size:clamp(18px,3.4vw,26px)}

.btn{
  appearance:none; border:1px solid var(--stroke); background:rgba(255,255,255,.08); color:var(--text);
  padding:10px 14px; border-radius:14px; cursor:pointer; font-weight:700; transition:transform .08s ease, box-shadow .12s ease
}
.btn:active{transform:scale(.98)}
.btn.primary{background:linear-gradient(90deg,var(--accent),var(--accent2)); color:#0b1020; border-color:transparent}

.hero{padding:6px 14px 12px}
.progress{height:8px; background:rgba(255,255,255,.08); border:1px solid var(--stroke); border-radius:999px; overflow:hidden}
.progress>i{display:block; height:100%; width:0%; background:linear-gradient(90deg,var(--accent),var(--accent2)); transition:width .35s ease}

.stage{display:grid; grid-template-columns:1fr; gap:12px; padding:10px 14px 14px}
.question{font-size:clamp(18px,3vw,22px); margin:2px 2px 4px}

.grid{
  display:grid; gap:14px;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  justify-items:center;
}
.card{
  display:flex; flex-direction:column; align-items:center;
  border:1px solid var(--stroke); background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
  border-radius:18px; width:100%; max-width:360px; padding:8px 10px 12px;
  box-shadow:0 6px 18px rgba(0,0,0,.25);
}
/* iPhone-safe, actually clickable */
.card>button{
  appearance:none; border:0; background:transparent;
  width:100%; display:flex; flex-direction:column; align-items:center;
  cursor:pointer; -webkit-tap-highlight-color:transparent; touch-action:manipulation;
  -webkit-user-select:none; user-select:none; min-height:44px;
}
.card>button:focus-visible{outline:3px solid #ffffff88; outline-offset:4px; border-radius:14px}

/* PIC tiles â€” 200Ã—200 exactly */
.imgbox{
  width:200px; height:200px; margin:8px auto 6px; border-radius:16px;
  display:grid; place-items:center;
  background:
    radial-gradient(600px 200px at 50% 0%, rgba(255,255,255,.12), rgba(255,255,255,.02)),
    linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
}
.emoji{font-size:92px; line-height:1}
.label{padding:10px 6px 4px; font-weight:800; text-align:center; color:var(--muted)}

.controls{display:flex; gap:10px; justify-content:space-between; align-items:center; padding:0 2px 10px}

.results{display:none; padding:10px 14px 14px}
.results.show{display:block}
.results-grid{
  display:grid; gap:14px;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  justify-items:center;
}

footer{padding:10px 14px 14px; display:flex; justify-content:space-between; align-items:center; color:var(--muted); font-size:14px}
.kbd{font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; border:1px solid var(--stroke); border-bottom-width:2px; padding:.1em .5em; border-radius:6px; background:rgba(255,255,255,.05)}

@media (max-width:560px){
  .grid,.results-grid{grid-template-columns:1fr}
  .card{max-width:420px}
}
</style>
</head>
<body>
<main class="app" id="app">
  <header>
    <div class="brand">
      <img class="logoimg" src="./logo_shensawi_neon.png" alt="Ø´Ù†Ø³ÙˆÙŠ â€” by Fahad" onerror="this.style.display='none'"/>
      <div class="title" id="appTitle">Ø´Ù†Ø³ÙˆÙŠ Ø§Ù„ÙˆÙŠÙƒÙ†Ø¯ØŸ</div>
    </div>
    <button class="btn" id="resetBtn" type="button" title="Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©">â†º Ø¥Ø¹Ø§Ø¯Ø©</button>
  </header>

  <div class="hero"><div class="progress" aria-hidden="true"><i id="bar"></i></div></div>

  <section class="stage" id="stage" aria-live="polite"></section>
  <section class="results" id="results"></section>

  <footer>
    <span class="muted">ÙÙ„ØªØ± Ø£Ù†Ø´Ø·Ø© â€” ØµÙˆØ± Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø¹Ù†Ø§ØµØ± Ù†Ø§Ø¦Ø¨Ø©.</span>
    <span class="muted">Tip: <span class="kbd">E</span> Ù„Ù„ØªØ­Ø±ÙŠØ± Ø§Ù„Ø³Ø±ÙŠØ¹.</span>
  </footer>
</main>

<script>
const DATA = {
  meta:{title:"Ø´Ù†Ø³ÙˆÙŠ Ø§Ù„ÙˆÙŠÙƒÙ†Ø¯ØŸ", rtl:true},
  questions:[
    {id:"q0_group", text:"Ù…Ù†Ùˆ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©ØŸ", options:[
      {id:"kids",   label:"Ø£Ø·ÙØ§Ù„",        emoji:"ğŸ§’", next:"q1_energy"},
      {id:"adults", label:"Ø¨Ø§Ù„ØºÙŠÙ†",       emoji:"ğŸ§‘â€ğŸ¤â€ğŸ§‘", next:"q1_energy"},
      {id:"mixed",  label:"Ø¹Ø§Ø¦Ù„Ø©/Ù…Ø®ØªÙ„Ø·",  emoji:"ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦", next:"q1_energy"}
    ]},
    {id:"q1_energy", text:"Ø§Ù„Ù…ÙˆØ¯ Ø´Ù†Ùˆ ØªØ¨ÙŠÙ‡ØŸ", options:[
      {id:"chill",    label:"Ù‡Ø§Ø¯ÙŠ ÙˆÙ…Ø±ÙŠØ­",    emoji:"ğŸ›‹ï¸", next:"q2_place"},
      {id:"creative", label:"Ø¥Ø¨Ø¯Ø§Ø¹ÙŠ/ØµÙ†Ø¹ Ø´ÙŠ", emoji:"ğŸ¨", next:"q2_place"},
      {id:"active",   label:"Ø­Ø±ÙƒÙŠ ÙˆÙ…Ù…ØªØ¹",    emoji:"âš¡ï¸", next:"q2_place"}
    ]},
    {id:"q2_place", text:"ÙˆÙŠÙ† ØªÙØ¶Ù„ØŸ", options:[
      {id:"indoor",  label:"Ø¯Ø§Ø®Ù„",           emoji:"ğŸ ", next:"q3_time"},
      {id:"outdoor", label:"Ø®Ø§Ø±Ø¬",           emoji:"ğŸŒ¤ï¸", next:"q3_time"},
      {id:"water",   label:"Ù‚Ø±ÙŠØ¨ Ù…Ù† Ø§Ù„Ø¨Ø­Ø±",  emoji:"ğŸŒŠ", next:"q3_time"},
      {id:"city",    label:"Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©",   emoji:"ğŸ™ï¸", next:"q3_time"}
    ]},
    {id:"q3_time", text:"Ø§Ù„Ù…Ø¯Ù‘Ø©ØŸ", options:[
      {id:"quick",   label:"Ø·Ù„Ø¹Ø© Ø³Ø±ÙŠØ¹Ø©",   emoji:"â±ï¸", next:"result:auto"},
      {id:"twoh",    label:"Ø­ÙˆØ§Ù„ÙŠ Ø³Ø§Ø¹ØªÙŠÙ†", emoji:"ğŸ•‘", next:"result:auto"},
      {id:"evening", label:"Ø³Ù‡Ø±Ø© ÙƒØ§Ù…Ù„Ø©",   emoji:"ğŸŒ™", next:"result:auto"}
    ]}
  ],
  activities:[
    {id:"bowling",title:"Ø¨ÙˆÙ„ÙŠÙ†Øº Ù…Ù…ØªØ¹",groups:["adults","mixed","kids"],energy:"active",place:"indoor",duration:["twoh"],desc:"Ù…Ø³Ø§Ø¨Ù‚Ø© Ø³Ø±ÙŠØ¹Ø© Ø¨Ø§Ù„ÙƒÙˆØ± ÙˆØ§Ù„Ø³ØªØ±Ø§ÙŠÙƒ."},
    {id:"trampoline",title:"ØªØ±Ø§Ù…Ø¨ÙˆÙ„ÙŠÙ† Ø¨Ø§Ø±Ùƒ",groups:["kids","mixed"],energy:"active",place:"indoor",duration:["twoh"],desc:"Ù‚ÙØ² ÙˆØ­Ø±Ù‚ Ø·Ø§Ù‚Ø©."},
    {id:"escape",title:"ØºØ±ÙØ© Ù‡Ø±ÙˆØ¨",groups:["adults","mixed"],energy:"active",place:"indoor",duration:["twoh"],desc:"Ø£Ù„ØºØ§Ø² Ø¬Ù…Ø§Ø¹ÙŠØ© ÙˆØ³Ø¨Ø§Ù‚ ÙˆÙ‚Øª."},
    {id:"laser",title:"Ù„Ø§ÙŠØ²Ø± ØªØ§Ø¬",groups:["mixed","adults","kids"],energy:"active",place:"indoor",duration:["twoh","quick"],desc:"ÙØ±Ù‚ ÙˆØªØ­Ø¯ÙŠØ§Øª Ù„ÙŠØ²Ø±."},
    {id:"arcade",title:"Ø£Ù„Ø¹Ø§Ø¨ Ø¢Ø±ÙƒÙŠØ¯ ÙˆVR",groups:["mixed","adults","kids"],energy:"active",place:"indoor",duration:["quick","twoh"],desc:"Ø³Ø¨Ø§Ù‚Ø§Øª ÙˆÙ…Ø­Ø§ÙƒÙŠØ§Øª."},
    {id:"bikes",title:"Ø¯Ø±Ø§Ø¬Ø§Øª/Ø³ÙƒÙˆØªØ±Ø§Øª Ø¨Ø§Ù„Ù…Ù…Ø´Ù‰",groups:["mixed","adults","kids"],energy:"active",place:"outdoor",duration:["twoh","quick"],desc:"Ù†ÙØ³ÙÙ…Ø© ÙˆÙ†Ø´Ø§Ø· Ø®ÙÙŠÙ."},
    {id:"kayak",title:"ÙƒØ§ÙŠØ§Ùƒ/Ù‚ÙˆØ§Ø±Ø¨",groups:["mixed","adults"],energy:"active",place:"water",duration:["twoh"],desc:"ØªØ¬Ø±Ø¨Ø© Ø¨Ø­Ø±ÙŠØ© Ù…Ù†Ø¹Ø´Ø©."},
    {id:"minigolf",title:"Ù…ÙŠÙ†ÙŠ ØºÙˆÙ„Ù",groups:["mixed","adults","kids"],energy:"active",place:"outdoor",duration:["twoh","quick"],desc:"Ù…Ù†Ø§ÙØ³Ø§Øª Ø¨Ø³ÙŠØ·Ø©."},
    {id:"climb",title:"ØªØ³Ù„Ù‚ Ø¬Ø¯Ø§Ø± Ø¯Ø§Ø®Ù„ÙŠ",groups:["mixed","adults"],energy:"active",place:"indoor",duration:["twoh"],desc:"ØªØ­Ø¯ÙŠ Ø¹Ø¶Ù„ÙŠ Ø¢Ù…Ù†."},
    {id:"iceskate",title:"ØªØ²Ù„Ø¬ Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù„ÙŠØ¯",groups:["mixed","adults","kids"],energy:"active",place:"indoor",duration:["twoh","quick"],desc:"Ù„ÙÙ‘Ø§Øª Ù…Ù…ØªØ¹Ø©."},
    {id:"cinema",title:"Ø³ÙŠÙ†Ù…Ø§",groups:["mixed","adults"],energy:"chill",place:"indoor",duration:["twoh","evening"],desc:"Ù…ÙˆÙÙŠ Ù†Ø§ÙŠØª."},
    {id:"corniche",title:"Ù…Ø´ÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙˆØ±Ù†ÙŠØ´",groups:["mixed","adults","kids"],energy:"chill",place:"water",duration:["quick","twoh"],desc:"Ù‡ÙˆØ§Ø¡ Ø¨Ø­Ø±."},
    {id:"beachsunset",title:"Ø´Ø§Ø·Ø¦ ÙˆÙ‚Øª Ø§Ù„ØºØ±ÙˆØ¨",groups:["mixed","adults","kids"],energy:"chill",place:"water",duration:["evening"],desc:"Ø£Ù„ÙˆØ§Ù† Ø§Ù„ØºØ±ÙˆØ¨."},
    {id:"parkplay",title:"Ø­Ø¯ÙŠÙ‚Ø© ÙˆÙ…Ù„Ø§Ø¹Ø¨",groups:["kids","mixed"],energy:"chill",place:"outdoor",duration:["twoh","quick"],desc:"Ø£Ù„Ø¹Ø§Ø¨ ÙˆØ±ÙƒØ¶."},
    {id:"boardcafe",title:"Ø¬Ù„Ø³Ø© Ø£Ù„Ø¹Ø§Ø¨ Ù„ÙˆØ­ÙŠØ©",groups:["mixed","adults","kids"],energy:"chill",place:"indoor",duration:["twoh"],desc:"ÙƒØ§ØªØ§Ù†/Ø£ÙˆÙ†Ùˆ."},
    {id:"library",title:"Ù…ÙƒØªØ¨Ø©/Ù‚Ø±Ø§Ø¡Ø©",groups:["adults","mixed"],energy:"chill",place:"indoor",duration:["quick","twoh"],desc:"Ù‚Ù‡ÙˆØ© ÙˆÙƒØªØ§Ø¨."},
    {id:"stargaze",title:"ØªØ£Ù…Ù„ Ù†Ø¬ÙˆÙ…",groups:["mixed","adults","kids"],energy:"chill",place:"outdoor",duration:["evening"],desc:"Ø³Ù…Ø§Ø¡ ØµØ§ÙÙŠØ©."},
    {id:"desertcoffee",title:"Ù‚Ø¹Ø¯Ø© ØµØ­Ø±Ø§ÙˆÙŠØ©",groups:["mixed","adults"],energy:"chill",place:"outdoor",duration:["evening"],desc:"Ù†Ø§Ø± ÙˆÙ‚Ù‡ÙˆØ©."},
    {id:"yoga",title:"ÙŠÙˆØºØ§/Ø§Ø³ØªØ±Ø®Ø§Ø¡",groups:["adults","mixed"],energy:"chill",place:"indoor",duration:["quick","twoh"],desc:"ØªÙ†ÙÙ‘Ø³ ÙˆÙ…Ø±ÙˆÙ†Ø©."},
    {id:"paint",title:"ÙˆØ±Ø´Ø© Ø±Ø³Ù…/ØªÙ„ÙˆÙŠÙ†",groups:["mixed","adults","kids"],energy:"creative",place:"indoor",duration:["twoh","quick"],desc:"Ø£Ù„ÙˆØ§Ù† ÙˆÙ„ÙˆØ­Ø§Øª."},
    {id:"pottery",title:"Ø®Ø²Ù ÙˆÙØ®Ø§Ø±",groups:["adults","mixed"],energy:"creative",place:"indoor",duration:["twoh"],desc:"Ø¹Ø¬Ù„Ø© ÙˆØªÙ„ÙˆÙŠÙ†."},
    {id:"science",title:"Ù…Ø±ÙƒØ² Ø¹Ù„ÙˆÙ…/ØªØ¬Ø§Ø±Ø¨",groups:["kids","mixed"],energy:"creative",place:"indoor",duration:["twoh"],desc:"ØªØ¹Ù„ÙŠÙ… Ù…Ù…ØªØ¹."},
    {id:"cityphoto",title:"Ø¬ÙˆÙ„Ø© ØªØµÙˆÙŠØ±",groups:["adults","mixed"],energy:"creative",place:"city",duration:["twoh"],desc:"Ø³ØªØ±ÙŠØª ÙÙˆØªÙˆ."},
    {id:"sandart",title:"ÙÙ† Ø¨Ø§Ù„Ø±Ù…Ù„",groups:["kids"],energy:"creative",place:"indoor",duration:["twoh","quick"],desc:"Ø¢Ù…Ù†Ø© Ù„Ù„ØµØºØ§Ø±."},
    {id:"mirrors",title:"Ù…ØªØ§Ù‡Ø© Ù…Ø±Ø§ÙŠØ§/Ø±Ø¹Ø¨",groups:["mixed","adults","kids"],energy:"creative",place:"indoor",duration:["quick"],desc:"ØªØ¬Ø±Ø¨Ø© Ø­Ø³Ù‘ÙŠØ©."},
    {id:"cook",title:"ÙˆØ±Ø´Ø© Ø·Ø¨Ø® Ø¹Ø§Ø¦Ù„ÙŠØ©",groups:["mixed"],energy:"creative",place:"indoor",duration:["twoh"],desc:"ÙˆØµÙØ© Ø³Ù‡Ù„Ø©."},
    {id:"craftmarket",title:"Ø³ÙˆÙ‚ Ø­Ø±ÙÙŠ",groups:["adults","mixed"],energy:"creative",place:"city",duration:["twoh","quick"],desc:"Ù…Ù†ØªØ¬Ø§Øª ÙÙ†ÙŠØ©."}
  ]
};

/* ---------- State ---------- */
const stageEl = document.getElementById('stage');
const resultsEl = document.getElementById('results');
const barEl = document.getElementById('bar');
const resetBtn = document.getElementById('resetBtn');
const titleEl = document.getElementById('appTitle');

let answers=[]; let currentQ=DATA.questions[0].id;
const qIndexById = Object.fromEntries(DATA.questions.map((q,i)=>[q.id,i]));

document.documentElement.dir = DATA.meta?.rtl===false ? 'ltr' : 'rtl';
titleEl.textContent = DATA.meta?.title || titleEl.textContent;

/* ---------- Render ---------- */
function render(){
  resultsEl.classList.remove('show');
  stageEl.innerHTML='';
  const q = DATA.questions[qIndexById[currentQ]];
  if(!q){ return showResults(); }

  const step = qIndexById[currentQ]+1;
  const total = DATA.questions.length;
  barEl.style.width = Math.round((step-1)/total*100)+'%';

  const qEl = document.createElement('div');
  qEl.className='question';
  qEl.textContent=q.text;
  stageEl.appendChild(qEl);

  const grid=document.createElement('div'); grid.className='grid';

  q.options.forEach(opt=>{
    const card=document.createElement('div'); card.className='card';
    const btn=document.createElement('button'); btn.type='button'; btn.setAttribute('aria-label', opt.label);
    btn.addEventListener('click', ()=>select(opt), {passive:true});

    const img=document.createElement('div'); img.className='imgbox';
    img.innerHTML=`<span class="emoji">${opt.emoji||'â­'}</span>`;
    const lab=document.createElement('div'); lab.className='label'; lab.textContent=opt.label;

    btn.appendChild(img); btn.appendChild(lab);
    card.appendChild(btn);
    grid.appendChild(card);
  });

  stageEl.appendChild(grid);

  const ctr=document.createElement('div'); ctr.className='controls';
  const back=document.createElement('button'); back.className='btn'; back.textContent='Ø±Ø¬ÙˆØ¹'; back.disabled=answers.length===0;
  back.addEventListener('click', goBack);
  const skip=document.createElement('button'); skip.className='btn'; skip.textContent='ØªØ®Ø·ÙŠ';
  skip.addEventListener('click', ()=>{
    answers.push({q:q.id,o:null});
    advance(q,{next:q.options[0]?.next||null});
  });
  ctr.appendChild(back); ctr.appendChild(skip);
  stageEl.appendChild(ctr);
}

function select(opt){
  const q = DATA.questions[qIndexById[currentQ]];
  answers.push({q:q.id,o:opt.id});
  advance(q,opt);
}

function advance(q,opt){
  const nxt=opt.next||null;
  if(nxt && nxt.startsWith('result:auto')) showResults();
  else if(nxt){ currentQ=nxt; render(); }
  else showResults();
}

function goBack(){
  if(!answers.length) return;
  answers.pop();
  const prev = answers.length ? answers[answers.length-1].q : DATA.questions[0].id;
  currentQ = prev; render();
}

/* ---------- Results ---------- */
function showResults(){
  stageEl.innerHTML='';
  barEl.style.width='100%';

  const prefs={
    group:getAnswer('q0_group'),
    energy:getAnswer('q1_energy'),
    place:getAnswer('q2_place'),
    time:getAnswer('q3_time')
  };

  const scored = DATA.activities.map(a=>{
    if(prefs.group && !a.groups.includes(prefs.group)) return null;
    let s=0;
    if(prefs.energy && a.energy===prefs.energy) s+=3;
    if(prefs.place){
      if(a.place===prefs.place) s+=3;
      else if((prefs.place==='water' && a.place==='outdoor')||(prefs.place==='outdoor' && a.place==='water')) s+=1;
      else if(prefs.place==='city' && (a.place==='indoor'||a.place==='outdoor')) s+=1;
    }
    if(prefs.time && a.duration?.includes(prefs.time)) s+=2;
    if(prefs.group==='mixed' && a.groups.includes('kids')) s+=1;
    return {a, s};
  }).filter(Boolean).sort((x,y)=>y.s-x.s);

  const picks = scored.slice(0, Math.max(3, Math.min(6, scored.length))).map(x=>x.a);
  resultsEl.innerHTML='';
  const title=document.createElement('div'); title.className='question'; title.textContent='Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª ØªÙ†Ø§Ø³Ø¨ Ø§Ø®ØªÙŠØ§Ø±Ø§ØªÙƒ';
  const grid=document.createElement('div'); grid.className='results-grid';

  (picks.length ? picks : DATA.activities.slice(0,3)).forEach(item=>{
    const card=document.createElement('div'); card.className='card';
    const img=document.createElement('div'); img.className='imgbox'; img.innerHTML=`<span class="emoji">âœ¨</span>`;
    const lab=document.createElement('div'); lab.className='label'; lab.innerHTML=`<div style="font-weight:800">${escapeHTML(item.title)}</div><div class="muted" style="font-weight:500">${escapeHTML(item.desc||'')}</div>`;
    card.appendChild(img); card.appendChild(lab);
    grid.appendChild(card);
  });

  resultsEl.appendChild(title);
  resultsEl.appendChild(grid);
  const ctr=document.createElement('div'); ctr.className='controls';
  const again=document.createElement('button'); again.className='btn primary'; again.textContent='Ø§Ø¨Ø¯Ø£ Ù…Ù† Ø¬Ø¯ÙŠØ¯'; again.addEventListener('click', reset);
  const tweak=document.createElement('button'); tweak.className='btn'; tweak.textContent='ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª'; tweak.addEventListener('click', ()=>goBack());
  ctr.appendChild(again); ctr.appendChild(tweak);
  resultsEl.appendChild(ctr);

  resultsEl.classList.add('show');
}

function getAnswer(qid){
  const found=[...answers].reverse().find(x=>x.q===qid && x.o!==null);
  return found?found.o:null;
}
function reset(){ answers=[]; currentQ=DATA.questions[0].id; render(); }
resetBtn.addEventListener('click', reset);

/* quick text edit mode */
let edit=false;
window.addEventListener('keydown',e=>{
  if(e.key.toLowerCase()==='e'){
    edit=!edit; alert(edit?'ÙˆØ¶Ø¹ Ø§Ù„ØªØ­Ø±ÙŠØ± Ø§Ù„Ø³Ø±ÙŠØ¹: Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ù†ØµÙˆØµ Ù„ØªØ¹Ø¯ÙŠÙ„Ù‡Ø§.':'ØªÙ… Ø¥ÙŠÙ‚Ø§Ù ÙˆØ¶Ø¹ Ø§Ù„ØªØ­Ø±ÙŠØ±.');
  }
});
stageEl.addEventListener('click',e=>{
  if(!edit) return; const el=e.target.closest('.label'); if(!el) return;
  const current=el.textContent.trim(); const next=prompt('Ø­Ø±Ù‘Ø± Ø§Ù„Ù†Øµ:', current);
  if(next!==null) el.textContent=next;
});

function escapeHTML(s){
  return (s||'').replace(/[&<>\"']/g, m => ({
    "&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"
  }[m]));
}

document.addEventListener('DOMContentLoaded',render);
</script>
</body>
</html>
