<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>شنسوي الويكند؟ — مُرشِّح الأنشطة</title>
  <style>
    :root{
      --bg1:#0f1022;--bg2:#132b38;--glass:rgba(255,255,255,.08);--stroke:rgba(255,255,255,.16);
      --text:#ffffff;--muted:#cfd8dc;--accent:#7cf3e0;--accent2:#b388ff;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; color:var(--text); font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Noto Kufi Arabic", "Noto Sans", Arial, sans-serif;
      background: radial-gradient(1200px 1200px at 10% -10%, #1e1b4b 0%, transparent 60%),
                  radial-gradient(900px 900px at 110% 10%, #0ea5e9 0%, transparent 50%),
                  linear-gradient(160deg,var(--bg1),var(--bg2));
      display:flex; align-items:center; justify-content:center; padding:24px;
    }
    .app{width:min(1100px,100%);}
    .glass{
      background:var(--glass); border:1px solid var(--stroke); backdrop-filter: blur(14px);
      box-shadow:0 10px 40px rgba(0,0,0,.35); border-radius:24px; overflow:hidden;
    }
    header{display:flex; align-items:center; justify-content:space-between; padding:16px 20px;}
    .brand{display:flex; gap:12px; align-items:center}
    .logo{width:42px;height:42px;border-radius:12px; background:conic-gradient(from 210deg, var(--accent2), var(--accent), #60a5fa, var(--accent2));
      display:grid; place-items:center; font-weight:800; letter-spacing:.5px; color:#0b1020}
    .title{font-weight:800; font-size:clamp(18px,3vw,28px)}

    .hero{padding:8px 20px 18px 20px;}
    .progress{height:8px; background:rgba(255,255,255,.08); border:1px solid var(--stroke); border-radius:999px; overflow:hidden;}
    .progress > i{display:block; height:100%; width:0%; background:linear-gradient(90deg,var(--accent),var(--accent2)); transition:width .35s ease}

    .stage{display:grid; grid-template-columns: 1fr; gap:16px; padding:18px 20px 24px 20px}
    .question{font-size:clamp(18px,3vw,22px); color:var(--text); margin:4px 2px 6px 2px}
    .grid{display:grid; gap:14px; grid-template-columns: repeat(auto-fill, minmax(190px, 1fr));}

    .card{position:relative; border:1px solid var(--stroke); background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      border-radius:20px; overflow:hidden; cursor:pointer; transition: transform .12s ease, border-color .12s ease, box-shadow .12s ease}
    .card:hover{transform:translateY(-2px); border-color:rgba(255,255,255,.28); box-shadow:0 8px 24px rgba(0,0,0,.35)}
    .imgbox{aspect-ratio:1/1; display:grid; place-items:center; background:radial-gradient(600px 200px at 50% 0%, rgba(255,255,255,.12), rgba(255,255,255,.02)),
        linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));}
    .imgbox svg{width:62%; height:62%; opacity:.9}
    .label{padding:12px 14px; font-weight:700; text-align:center; color:var(--muted)}
    .muted{color:var(--muted)}

    .controls{display:flex; gap:10px; justify-content:space-between; align-items:center; padding:0 2px}
    .btn{appearance:none; border:1px solid var(--stroke); background:rgba(255,255,255,.06); color:var(--text);
      padding:10px 14px; border-radius:14px; cursor:pointer; font-weight:700; transition:filter .12s ease, transform .08s ease}
    .btn:active{transform:scale(.98)}
    .btn.primary{background:linear-gradient(90deg,var(--accent),var(--accent2)); color:#0b1020; border-color:transparent}

    .results{display:none; padding:22px 20px 26px}
    .results.show{display:block}
    .results-grid{display:grid; gap:14px; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));}
    .results .card{margin:0}

    footer{padding:14px 20px 20px; display:flex; justify-content:space-between; align-items:center; color:var(--muted); font-size:14px}
    .kbd{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; border:1px solid var(--stroke); border-bottom-width:2px;
      padding:.1em .5em; border-radius:6px; background:rgba(255,255,255,.05)}

    @media (max-width:560px){
      .grid{grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));}
      .results-grid{grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));}
    }
  </style>
</head>
<body>
  <main class="app glass" id="app">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true">WK</div>
        <div class="title" id="appTitle">شنسوي الويكند؟</div>
      </div>
      <button class="btn" id="resetBtn" title="إعادة البداية">↺ إعادة</button>
    </header>

    <div class="hero">
      <div class="progress" aria-hidden="true"><i id="bar"></i></div>
    </div>

    <section class="stage" id="stage" aria-live="polite"></section>

    <section class="results" id="results"></section>

    <footer>
      <span class="muted">فلتر أنشطة — صور النتائج عناصر نائبة مؤقتًا.</span>
      <span class="muted">Tip: اضغط <span class="kbd">E</span> لتبديل التحرير السريع للنصوص.</span>
    </footer>
  </main>

  <script>
  // ===============================
  // DATA (with activities catalog)
  // ===============================
  const DATA = {
    meta: {
      title: "شنسوي الويكند؟",
      rtl: true
    },

    // Q0: Group -> Kids / Adults / Mixed
    // ثم الطاقة -> المكان -> المدة
    questions: [
      {
        id: "q0_group",
        text: "منو المجموعة؟",
        options: [
          { id: "kids",   label: "أطفال",           image: "placeholder:calm", next: "q1_energy" },
          { id: "adults", label: "بالغين",          image: "placeholder:bold", next: "q1_energy" },
          { id: "mixed",  label: "عائلة/مختلط",     image: "placeholder:classic", next: "q1_energy" }
        ]
      },
      {
        id: "q1_energy",
        text: "المود شنو تبيه؟",
        options: [
          { id: "chill",    label: "هادي ومريح",  image: "placeholder:soft", next: "q2_place" },
          { id: "creative", label: "إبداعي/صنع شي", image: "placeholder:minimal", next: "q2_place" },
          { id: "active",   label: "حركي وممتع",  image: "placeholder:fun", next: "q2_place" }
        ]
      },
      {
        id: "q2_place",
        text: "وين تفضل؟",
        options: [
          { id: "indoor", label: "داخل",       image: "placeholder:indoor", next: "q3_time" },
          { id: "outdoor", label: "خارج",      image: "placeholder:outdoor", next: "q3_time" },
          { id: "water",  label: "قريب من البحر", image: "placeholder:sea", next: "q3_time" },
          { id: "city",   label: "أماكن المدينة", image: "placeholder:city", next: "q3_time" }
        ]
      },
      {
        id: "q3_time",
        text: "المدّة؟",
        options: [
          { id: "quick",  label: "طلعة سريعة",   image: "placeholder:short", next: "result:auto" },
          { id: "twoh",   label: "حوالي ساعتين", image: "placeholder:mid",   next: "result:auto" },
          { id: "evening",label: "سهرة كاملة",   image: "placeholder:long",  next: "result:auto" }
        ]
      }
    ],

    // Catalog of activities (images are placeholders/optional)
    activities: [
      // ==== Active =====
      { id:"bowling", title:"بولينغ ممتع", groups:["adults","mixed","kids"], energy:"active", place:"indoor", duration:["twoh"], image:"", desc:"مسابقة سريعة بالكور والسترايك." },
      { id:"trampoline", title:"ترامبولين بارك", groups:["kids","mixed"], energy:"active", place:"indoor", duration:["twoh"], image:"", desc:"قفز وحرق طاقة آمنة وممتعة." },
      { id:"escape", title:"غرفة هروب", groups:["adults","mixed"], energy:"active", place:"indoor", duration:["twoh"], image:"", desc:"ألغاز جماعية وسباق مع الوقت." },
      { id:"laser", title:"لايزر تاج", groups:["mixed","adults","kids"], energy:"active", place:"indoor", duration:["twoh","quick"], image:"", desc:"قتال ليزري آمن، فرق وتحديات." },
      { id:"arcade", title:"ألعاب آركيد وVR", groups:["mixed","adults","kids"], energy:"active", place:"indoor", duration:["quick","twoh"], image:"", desc:"سباقات ومحاكيات وتجارب VR." },
      { id:"bikes", title:"دراجات/سكوترات في الممشى", groups:["mixed","adults","kids"], energy:"active", place:"outdoor", duration:["twoh","quick"], image:"", desc:"لفة هواء عليل ونشاط خفيف." },
      { id:"kayak", title:"كاياك/قوارب", groups:["mixed","adults"], energy:"active", place:"water", duration:["twoh"], image:"", desc:"تجربة بحرية سهلة ومنعشة." },
      { id:"minigolf", title:"ميني غولف", groups:["mixed","adults","kids"], energy:"active", place:"outdoor", duration:["twoh","quick"], image:"", desc:"ثقوب مرحة ومنافسات بسيطة." },
      { id:"climb", title:"تسلق جدار داخلي", groups:["mixed","adults"], energy:"active", place:"indoor", duration:["twoh"], image:"", desc:"تحدي عضلي آمن مع أحزمة." },
      { id:"iceskate", title:"تزلج على الجليد", groups:["mixed","adults","kids"], energy:"active", place:"indoor", duration:["twoh","quick"], image:"", desc:"لفّات جليدية ممتعة." },

      // ==== Chill =====
      { id:"cinema", title:"سينما", groups:["mixed","adults"], energy:"chill", place:"indoor", duration:["twoh","evening"], image:"", desc:"فيلم جديد وموفي نايت." },
      { id:"corniche", title:"مشية على الكورنيش", groups:["mixed","adults","kids"], energy:"chill", place:"water", duration:["quick","twoh"], image:"", desc:"هواء بحر وجلسة مريحة." },
      { id:"beachsunset", title:"شاطئ وقت الغروب", groups:["mixed","adults","kids"], energy:"chill", place:"water", duration:["evening"], image:"", desc:"ألوان الغروب وهدوء البحر." },
      { id:"parkplay", title:"حديقة وملاعب", groups:["kids","mixed"], energy:"chill", place:"outdoor", duration:["twoh","quick"], image:"", desc:"ألعاب وركض خفيف." },
      { id:"boardcafe", title:"جلسة ألعاب لوحية", groups:["mixed","adults","kids"], energy:"chill", place:"indoor", duration:["twoh"], image:"", desc:"كاتان/أونو/مونوبولي بلا ملل." },
      { id:"library", title:"مكتبة/قراءة", groups:["adults","mixed"], energy:"chill", place:"indoor", duration:["quick","twoh"], image:"", desc:"قهوة وكتاب وجو هادئ." },
      { id:"stargaze", title:"تأمل نجوم", groups:["mixed","adults","kids"], energy:"chill", place:"outdoor", duration:["evening"], image:"", desc:"سجادة وسماء صافية وتطبيق فلك." },
      { id:"desertcoffee", title:"قعدة صحراوية خفيفة", groups:["mixed","adults"], energy:"chill", place:"outdoor", duration:["evening"], image:"", desc:"جلسة ونار وقهوة." },
      { id:"yoga", title:"يوغا/استرخاء جماعي", groups:["adults","mixed"], energy:"chill", place:"indoor", duration:["quick","twoh"], image:"", desc:"تنفّس وتمارين مرونة." },

      // ==== Creative =====
      { id:"paint", title:"ورشة رسم/تلوين", groups:["mixed","adults","kids"], energy:"creative", place:"indoor", duration:["twoh","quick"], image:"", desc:"لوحات وألوان وإطارات." },
      { id:"pottery", title:"خزف وصناعة فخار", groups:["adults","mixed"], energy:"creative", place:"indoor", duration:["twoh"], image:"", desc:"عجلة خزف وتلوين القطع." },
      { id:"science", title:"مركز علوم/تجارب", groups:["kids","mixed"], energy:"creative", place:"indoor", duration:["twoh"], image:"", desc:"تعليم ممتع وتجارب بسيطة." },
      { id:"cityphoto", title:"جولة تصوير في المدينة", groups:["adults","mixed"], energy:"creative", place:"city", duration:["twoh"], image:"", desc:"لقطات جمالية وستريت فوتو." },
      { id:"sandart", title:"لوحات رمل/أعمال يدوية", groups:["kids"], energy:"creative", place:"indoor", duration:["twoh","quick"], image:"", desc:"إبداعات آمنة للصغار." },
      { id:"mirrors", title:"متاهة مرايا/بيت رعب", groups:["mixed","adults","kids"], energy:"creative", place:"indoor", duration:["quick"], image:"", desc:"تجربة حسّية مسلية." },
      { id:"cook", title:"ورشة طبخ عائلية", groups:["mixed"], energy:"creative", place:"indoor", duration:["twoh"], image:"", desc:"وصفة سهلة وفون مع العائلة." },
      { id:"craftmarket", title:"سوق حرفي محلي", groups:["adults","mixed"], energy:"creative", place:"city", duration:["twoh","quick"], image:"", desc:"أعمال يدوية ومنتجات فنية." }
    ]
  };

  // ============= RENDER/STATE =============
  const stageEl = document.getElementById('stage');
  const resultsEl = document.getElementById('results');
  const barEl = document.getElementById('bar');
  const resetBtn = document.getElementById('resetBtn');
  const titleEl = document.getElementById('appTitle');

  let answers = []; // [{q, o}]
  let currentQ = DATA.questions[0]?.id || null;
  const qIndexById = Object.fromEntries(DATA.questions.map((q,i)=>[q.id,i]));

  // apply meta
  document.documentElement.dir = DATA.meta?.rtl === false ? 'ltr' : 'rtl';
  titleEl.textContent = DATA.meta?.title || titleEl.textContent;

  function render(){
    resultsEl.classList.remove('show');
    stageEl.innerHTML = '';

    const q = DATA.questions[qIndexById[currentQ]];
    if(!q){ return showAutoResults(); }

    // progress
    const step = qIndexById[currentQ] + 1;
    const total = DATA.questions.length;
    barEl.style.width = Math.round((step-1)/total*100) + '%';

    const qEl = document.createElement('div');
    qEl.className = 'question';
    qEl.textContent = q.text;
    stageEl.appendChild(qEl);

    const grid = document.createElement('div');
    grid.className = 'grid';

    q.options.forEach(opt=>{
      const card = document.createElement('article');
      card.className = 'card';
      card.setAttribute('role','button');
      card.setAttribute('tabindex','0');
      card.addEventListener('click', ()=>select(opt));
      card.addEventListener('keyup', (e)=>{ if(e.key==='Enter' || e.key===' '){ select(opt); }});

      const img = document.createElement('div');
      img.className = 'imgbox';
      img.innerHTML = renderPlaceholder(opt.image);

      const lab = document.createElement('div');
      lab.className = 'label';
      lab.textContent = opt.label;

      card.appendChild(img); card.appendChild(lab);
      grid.appendChild(card);
    });

    stageEl.appendChild(grid);

    // controls
    const controls = document.createElement('div');
    controls.className = 'controls';
    const back = document.createElement('button'); back.className = 'btn'; back.textContent = 'رجوع';
    back.disabled = answers.length===0;
    back.addEventListener('click', goBack);

    const skip = document.createElement('button'); skip.className = 'btn'; skip.textContent = 'تخطي';
    skip.addEventListener('click', ()=>{
      answers.push({ q: q.id, o: null });
      advance(q, { next: q.options[0]?.next || null }, true);
    });

    controls.appendChild(back); controls.appendChild(skip);
    stageEl.appendChild(controls);
  }

  function select(opt){
    const q = DATA.questions[qIndexById[currentQ]];
    answers.push({ q: q.id, o: opt.id });
    advance(q, opt, false);
  }

  function advance(q, opt){
    const nxt = opt.next || null;
    if(nxt && nxt.startsWith('result:auto')){
      showAutoResults();
    }else if(nxt){
      currentQ = nxt;
      render();
    }else{
      showAutoResults();
    }
  }

  function goBack(){
    if(answers.length===0){return}
    answers.pop();
    const prevQ = answers.length ? answers[answers.length-1].q : DATA.questions[0].id;
    currentQ = prevQ;
    render();
  }

  // ======= RESULT SELECTION (scored filter) =======
  function showAutoResults(){
    stageEl.innerHTML = '';
    barEl.style.width = '100%';

    const prefs = {
      group: getAnswer("q0_group"),
      energy: getAnswer("q1_energy"),
      place: getAnswer("q2_place"),
      time: getAnswer("q3_time")
    };

    // score each activity
    const scored = DATA.activities.map(a=>{
      let okGroup = !prefs.group || a.groups.includes(prefs.group);
      if(!okGroup) return null;

      let score = 0;
      if(prefs.energy && a.energy === prefs.energy) score += 3;
      if(prefs.place){
        if(a.place === prefs.place) score += 3;
        else if(prefs.place==="water" && a.place==="outdoor") score += 1; // near-match
        else if(prefs.place==="outdoor" && a.place==="water") score += 1;
        else if(prefs.place==="city" && (a.place==="indoor"||a.place==="outdoor")) score += 1;
      }
      if(prefs.time && (a.duration?.includes(prefs.time))) score += 2;

      // light boost if activity is family-friendly when group mixed
      if(prefs.group==="mixed" && a.groups.includes("kids")) score += 1;

      return { a, score };
    }).filter(Boolean).sort((x,y)=>y.score-x.score);

    const top = scored.slice(0, Math.max(3, Math.min(5, scored.length))).map(s=>s.a);

    const wrap = document.createElement('div');
    wrap.innerHTML = `<div class="question">اقتراحات تناسب اختياراتك</div>`;
    const grid = document.createElement('div');
    grid.className = 'results-grid';

    (top.length? top : fallbackList()).forEach(item=>{
      const card = document.createElement('article'); card.className='card';
      const img = document.createElement('div'); img.className='imgbox';
      img.innerHTML = item.image ? `<img alt="" src="${item.image}" style="width:100%;height:100%;object-fit:cover;"/>` : svgStar(item.title);
      const lab = document.createElement('div'); lab.className='label';
      lab.innerHTML = `<div>${escapeHTML(item.title)}</div><div class="muted" style="font-weight:500">${escapeHTML(item.desc||"")}</div>`;
      card.appendChild(img); card.appendChild(lab);
      grid.appendChild(card);
    });

    resultsEl.innerHTML = '';
    wrap.appendChild(grid);
    resultsEl.appendChild(wrap);
    resultsEl.classList.add('show');

    // controls under result
    const ctr = document.createElement('div');
    ctr.className = 'controls';
    const again = document.createElement('button'); again.className = 'btn primary'; again.textContent = 'ابدأ من جديد';
    again.addEventListener('click', reset);
    const tweak = document.createElement('button'); tweak.className = 'btn'; tweak.textContent = 'تعديل الاختيارات';
    tweak.addEventListener('click', ()=>{ goBack(); });
    ctr.appendChild(again); ctr.appendChild(tweak);
    resultsEl.appendChild(ctr);
  }

  function getAnswer(qid){
    const found = [...answers].reverse().find(x=>x.q===qid && x.o!==null);
    return found ? found.o : null;
  }

  function fallbackList(){
    // في حال ما طلع شي (نادرًا)
    return DATA.activities.slice(0,3);
  }

  function reset(){ answers = []; currentQ = DATA.questions[0]?.id || null; render(); }
  resetBtn.addEventListener('click', reset);

  function escapeHTML(s){return (s||'').replace(/[&<>\"']/g, m=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[m]))}

  // ====== Placeholder renderers (inline SVG icons) ======
  const ICONS = {
    calm: svgCircle(""),
    fun: svgBurst(""),
    adventure: svgPath(""),
    chill: svgWave(""),
    indoor: svgHouse(""),
    outdoor: svgSun(""),
    sea: svgSea(""),
    city: svgCity(""),
    short: svgClock(""),
    mid: svgClock(""),
    long: svgClock(""),
    soft: svgBlend(""),
    bold: svgBolt(""),
    minimal: svgGrid(""),
    classic: svgStar("")
  };
  function renderPlaceholder(code){
    if(!code || !code.startsWith('placeholder:')) return `<div></div>`;
    const key = code.split(':')[1];
    if(ICONS[key]) return ICONS[key];
    return svgStar('');
  }
  function svgWrap(inner, label){
    return `<svg viewBox="0 0 100 100" role="img" aria-label="${label||''}" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <linearGradient id="g1" x1="0" y1="0" x2="1" y2="1">
          <stop offset="0%" stop-color="#7cf3e0"/>
          <stop offset="100%" stop-color="#b388ff"/>
        </linearGradient>
      </defs>
      <rect x="0" y="0" width="100" height="100" rx="18" fill="url(#g1)" opacity=".25"/>
      ${inner}
    </svg>`;
  }
  function svgCircle(t){return svgWrap(`<circle cx="50" cy="50" r="26" fill="none" stroke="#7cf3e0" stroke-width="6"/><text x="50" y="56" text-anchor="middle" font-size="12" fill="#e0f2f1">${t||''}</text>`, t)}
  function svgBurst(t){return svgWrap(`<g stroke="#b388ff" stroke-width="6" fill="none"><path d="M50 12 L58 34 L82 34 L62 48 L70 70 L50 56 L30 70 L38 48 L18 34 L42 34 Z"/></g><text x="50" y="90" text-anchor="middle" font-size="12" fill="#f3e8ff">${t||''}</text>`, t)}
  function svgPath(t){return svgWrap(`<path d="M18,80 C30,30 70,70 82,20" stroke="#7cf3e0" stroke-width="6" fill="none"/><text x="50" y="90" text-anchor="middle" font-size="12" fill="#c8fff4">${t||''}</text>`, t)}
  function svgWave(t){return svgWrap(`<path d="M0,60 Q25,40 50,60 T100,60" stroke="#7cf3e0" stroke-width="6" fill="none"/><text x="50" y="90" text-anchor="middle" font-size="12" fill="#c8fff4">${t||''}</text>`, t)}
  function svgHouse(t){return svgWrap(`<path d="M20 60 L50 30 L80 60 V80 H20 Z" fill="none" stroke="#7cf3e0" stroke-width="6"/><text x="50" y="90" text-anchor="middle" font-size="12" fill="#c8fff4">${t||''}</text>`, t)}
  function svgSun(t){return svgWrap(`<circle cx="50" cy="50" r="18" fill="none" stroke="#b388ff" stroke-width="6"/><g stroke="#b388ff" stroke-width="4">${Array.from({length:12}).map((_,i)=>{const a=i*30*Math.PI/180; const x1=50+Math.cos(a)*26; const y1=50+Math.sin(a)*26; const x2=50+Math.cos(a)*38; const y2=50+Math.sin(a)*38; return `<line x1="${x1}" y1="${y1}" x2="${x2}" y2="${y2}"/>`}).join('')}</g><text x="50" y="90" text-anchor="middle" font-size="12" fill="#f3e8ff">${t||''}</text>`, t)}
  function svgSea(t){return svgWrap(`<path d="M10,70 Q25,62 40,70 T70,70 T100,70" stroke="#7cf3e0" stroke-width="6" fill="none"/><text x="50" y="90" text-anchor="middle" font-size="12" fill="#c8fff4">${t||''}</text>`, t)}
  function svgCity(t){return svgWrap(`<g stroke="#7cf3e0" stroke-width="6" fill="none"><rect x="18" y="50" width="18" height="30"/><rect x="42" y="40" width="16" height="40"/><rect x="64" y="58" width="18" height="22"/></g><text x="50" y="90" text-anchor="middle" font-size="12" fill="#c8fff4">${t||''}</text>`, t)}
  function svgClock(t){return svgWrap(`<circle cx="50" cy="50" r="26" fill="none" stroke="#b388ff" stroke-width="6"/><line x1="50" y1="50" x2="50" y2="34" stroke="#b388ff" stroke-width="6"/><line x1="50" y1="50" x2="64" y2="50" stroke="#b388ff" stroke-width="6"/><text x="50" y="90" text-anchor="middle" font-size="12" fill="#f3e8ff">${t||''}</text>`, t)}
  function svgBlend(t){return svgWrap(`<defs><linearGradient id="g2" x1="0" y="0" x2="1" y="1"><stop offset="0%" stop-color="#e0f7fa"/><stop offset="100%" stop-color="#ede7f6"/></linearGradient></defs><circle cx="50" cy="50" r="26" fill="url(#g2)" opacity=".7"/><text x="50" y="90" text-anchor="middle" font-size="12" fill="#e0f2f1">${t||''}</text>`, t)}
  function svgBolt(t){return svgWrap(`<path d="M44 18 L28 56 H48 L40 82 L72 46 H52 L60 18 Z" fill="none" stroke="#ffd76a" stroke-width="6"/><text x="50" y="90" text-anchor="middle" font-size="12" fill="#fff3c0">${t||''}</text>`, t)}
  function svgGrid(t){return svgWrap(`<g stroke="#7cf3e0" stroke-width="6" opacity=".9"><line x1="20" y1="40" x2="80" y2="40"/><line x1="20" y1="60" x2="80" y2="60"/><line x1="40" y1="20" x2="40" y2="80"/><line x1="60" y1="20" x2="60" y2="80"/></g><text x="50" y="90" text-anchor="middle" font-size="12" fill="#c8fff4">${t||''}</text>`, t)}
  function svgStar(t){return svgWrap(`<path d="M50 16 L58 38 L82 38 L62 52 L70 74 L50 60 L30 74 L38 52 L18 38 L42 38 Z" fill="none" stroke="#7cf3e0" stroke-width="6"/><text x="50" y="90" text-anchor="middle" font-size="12" fill="#c8fff4">${t||''}</text>`, t)}

  // ===== Quick Edit Mode (press E) =====
  let edit = false;
  window.addEventListener('keydown', (e)=>{
    if(e.key.toLowerCase()==='e'){
      edit = !edit; document.body.classList.toggle('edit', edit);
      alert(edit ? 'وضع التحرير السريع: اضغط على النصوص لتعديلها (مؤقت داخل المتصفح).' : 'تم إيقاف وضع التحرير.');
    }
  });
  stageEl.addEventListener('click', (e)=>{
    if(!edit) return;
    const el = e.target.closest('.label');
    if(!el) return;
    const current = el.textContent.trim();
    const next = prompt('حرّر النص:', current);
    if(next!==null){ el.textContent = next; }
  });

  // start
  render();
  </script>
</body>
</html>
